<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beatriz Management - Portal de Gest√£o de Alunos</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="profile-circle">
                   <img src="img/image.jgp" alt="Foto da Beatriz">
                </div>
                <h2>‚ú®Ol√°, Beatriz!‚ú®</h2>
                <p>Gest√£o de Alunos & Performance</p>
            </div>
            <nav class="sidebar-nav">
                <button class="nav-btn active" onclick="goToPage('dashboard')">
                    üìä Dashboard
                </button>
                <button class="nav-btn" onclick="goToPage('alunos')">
                    üë• Meus Alunos
                </button>
                <button class="nav-btn" onclick="goToPage('modulos')">
                    üìö M√≥dulos & Aulas
                </button>
                <button class="nav-btn" onclick="goToPage('presencas')">
                    ‚úì Presen√ßa
                </button>
                <button class="nav-btn" onclick="goToPage('financeiro')">
                    üí∞ Financeiro
                </button>
                <button class="nav-btn" onclick="goToPage('relatorios')">
                    üìà Relat√≥rios
                </button>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <section id="dashboard" class="page active">
                <div class="page-header">
                    <h1>Dashboard de Performance</h1>
                    <p class="subtitle">Vis√£o geral da sua produtividade e dos seus alunos</p>
                </div>

                <div class="cards-grid">
                    <div class="stat-card">
                        <div class="card-icon">üë•</div>
                        <h3>Alunos Ativos</h3>
                        <p class="stat-value" id="total-alunos">0</p>
                        <span class="card-desc">Foco nos alunos em curso</span>
                    </div>
                    <div class="stat-card">
                        <div class="card-icon">üìö</div>
                        <h3>M√≥dulos Ativos</h3>
                        <p class="stat-value" id="total-modulos">0</p>
                        <span class="card-desc">Turmas em funcionamento</span>
                    </div>
                    <div class="stat-card alert">
                        <div class="card-icon">‚ö†Ô∏è</div>
                        <h3>Pagamentos Atrasados</h3>
                        <p class="stat-value" id="pagamentos-atrasados">0</p>
                        <span class="card-desc">Requer aten√ß√£o</span>
                    </div>
                    <div class="stat-card alert">
                        <div class="card-icon">üí≥</div>
                        <h3>Alunos Devedores</h3>
                        <p class="stat-value" id="alunos-devedores">0</p>
                        <span class="card-desc">Com d√©bitos pendentes</span>
                    </div>
                </div>

                <div class="actions-section">
                    <h2>A√ß√µes R√°pidas</h2>
                    <div class="actions-grid">
                        <button class="action-btn" onclick="goToPage('alunos')">
                            <span class="action-icon">üë•</span>
                            Gerenciar Alunos
                        </button>
                        <button class="action-btn" onclick="goToPage('modulos')">
                            <span class="action-icon">üìö</span>
                            M√≥dulos & Aulas
                        </button>
                        <button class="action-btn" onclick="goToPage('presencas')">
                            <span class="action-icon">‚úì</span>
                            Registrar Presen√ßa
                        </button>
                        <button class="action-btn" onclick="goToPage('financeiro')">
                            <span class="action-icon">üí∞</span>
                            Financeiro
                        </button>
                    </div>
                </div>
            </section>

            <!-- Alunos Page -->
            <section id="alunos" class="page">
                <div class="page-header">
                    <h1>Gest√£o de Alunos</h1>
                    <button class="btn-primary" onclick="openAlunoModal()">+ Novo Aluno</button>
                </div>

                <div class="search-bar">
                    <input type="text" id="search-alunos" placeholder="Buscar aluno..." onkeyup="filterAlunos()">
                    <select id="filter-status" onchange="filterAlunos()">
                        <option value="">Todos os status</option>
                        <option value="ativo">Ativo</option>
                        <option value="inativo">Inativo</option>
                        <option value="pausado">Pausado</option>
                    </select>
                    <select id="filter-curso" onchange="filterAlunos()">
                        <option value="">Todos os cursos</option>
                        <option value="Ingl√™s B√°sico">Ingl√™s B√°sico</option>
                        <option value="Ingl√™s Avan√ßado">Ingl√™s Avan√ßado</option>
                        <option value="Particular">Particular</option>
                    </select>
                </div>

                <div id="alunos-list" class="alunos-grid">
                    <!-- Alunos ser√£o adicionados aqui -->
                </div>
            </section>

            <!-- M√≥dulos Page -->
            <section id="modulos" class="page">
                <div class="page-header">
                    <h1>M√≥dulos & Aulas</h1>
                    <button class="btn-primary" onclick="openModuloModal()">+ Novo M√≥dulo</button>
                </div>

                <div class="modulos-container">
                    <div class="modulos-sidebar">
                        <h3>Seus M√≥dulos</h3>
                        <div id="modulos-list">
                            <!-- M√≥dulos ser√£o adicionados aqui -->
                        </div>
                    </div>
                    <div class="aulas-panel">
                        <h3>Cronograma de Aulas</h3>
                        <button class="btn-primary" id="btn-nova-aula" onclick="openAulaModal()" style="display:none;">+ Nova Aula</button>
                        <div id="aulas-list">
                            <p class="empty-state">Selecione um m√≥dulo para ver suas aulas</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Presen√ßa Page -->
            <section id="presencas" class="page">
                <div class="page-header">
                    <h1>Controle de Presen√ßa</h1>
                </div>

                <div class="presenca-form">
                    <div class="filter-row">
                        <div class="filter-group">
                            <label>1. Selecione o M√≥dulo:</label>
                            <select id="select-modulo-presenca" onchange="carregarAulasDoModulo()">
                                <option value="">-- Selecione um m√≥dulo --</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>2. Selecione a Aula:</label>
                            <select id="select-aula" onchange="carregarPresencas()">
                                <option value="">-- Selecione primeiro o m√≥dulo --</option>
                            </select>
                        </div>
                    </div>

                    <div id="presencas-table" style="margin-top: 20px;">
                        <!-- Presen√ßa dos alunos ser√° adicionada aqui -->
                    </div>
                </div>
            </section>

            <!-- Financeiro Page -->
            <section id="financeiro" class="page">
                <div class="page-header">
                    <h1>Controle Financeiro</h1>
                    <button class="btn-secondary" onclick="limparRegistrosAntigos()" style="color: var(--danger); border-color: var(--danger);">Limpar Registros Antigos</button>
                </div>

                <div class="financeiro-filters">
                    <select id="filter-financeiro-status" onchange="loadFinanceiro()">
                        <option value="">Todos os status</option>
                        <option value="pago">Pago</option>
                        <option value="pendente">Pendente</option>
                        <option value="atrasado">Atrasado</option>
                    </select>
                    <select id="filter-financeiro-mes" onchange="loadFinanceiro()">
                        <option value="">Todos os meses</option>
                        <!-- Meses ser√£o preenchidos via JS -->
                    </select>
                    <select id="filter-financeiro-modulo" onchange="loadFinanceiro()">
                        <option value="">Todos os m√≥dulos</option>
                        <!-- M√≥dulos ser√£o preenchidos via JS -->
                    </select>
                </div>

                <div class="table-container">
                    <table class="financeiro-table">
                        <thead>
                            <tr>
                                <th>Aluno</th>
                                <th>Descri√ß√£o</th>
                                <th>Valor</th>
                                <th>Vencimento</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="financeiro-table-body">
                            <!-- Pagamentos ser√£o adicionados aqui -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Relat√≥rios Page -->
            <section id="relatorios" class="page">
                <div class="page-header">
                    <h1>Relat√≥rios & Estat√≠sticas</h1>
                    <div style="display: flex; gap: 10px;">
                        <select id="export-month-select" class="btn-secondary" style="padding: 5px 10px; font-size: 12px;">
                            <option value="">M√™s Atual</option>
                        </select>
                        <button class="btn-primary" onclick="exportarRelatorioPDF()">üìÑ Exportar PDF</button>
                    </div>
                </div>

                <div class="relatorios-container">
                    <div class="relatorio-section">
                        <div class="section-header" onclick="toggleSection('resumo-mensal-content')">
                            <h2>Resumo Mensal (Foco em Ativos)</h2>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div id="resumo-mensal-content" class="collapsible-content active">
                        <div class="resumo-grid">
                            <div class="resumo-card">
                                <h4>Alunos Ativos</h4>
                                <p class="resumo-value" id="rel-total-alunos">0</p>
                            </div>
                            <div class="resumo-card">
                                <h4>Frequ√™ncia M√©dia</h4>
                                <p class="resumo-value" id="rel-frequencia-media">0%</p>
                            </div>
                            <div class="resumo-card">
                                <h4>Receita Total (Paga)</h4>
                                <p class="resumo-value" id="rel-receita-total">R$ 0,00</p>
                            </div>
                            <div class="resumo-card alert">
                                <h4>Pend√™ncias Totais</h4>
                                <p class="resumo-value" id="rel-pendencias">R$ 0,00</p>
                            </div>
                        </div>
                    </div>

                    </div> <!-- End Resumo Mensal -->

                    <div class="relatorio-section">
                        <div class="section-header" onclick="toggleSection('graficos-content')">
                            <h2>Vis√£o Estat√≠stica (Gr√°ficos)</h2>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div id="graficos-content" class="collapsible-content active">
                            <div class="charts-grid">
                                <div class="chart-container">
                                    <canvas id="chart-financeiro"></canvas>
                                </div>
                                <div class="chart-container">
                                    <canvas id="chart-alunos-nivel"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="relatorio-section">
                        <div class="section-header" onclick="toggleSection('desempenho-content')">
                            <h2>Desempenho por Aluno</h2>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div id="desempenho-content" class="collapsible-content active">
                        <div class="table-container">
                            <table class="relatorio-table">
                                <thead>
                                    <tr>
                                        <th>Aluno</th>
                                        <th>Curso</th>
                                        <th>Frequ√™ncia</th>
                                        <th>M√©dia de Notas</th>
                                        <th>Situa√ß√£o</th>
                                        <th>A√ß√µes</th>
                                    </tr>
                                </thead>
                                <tbody id="relatorio-alunos">
                                    <!-- Dados ser√£o injetados aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    </div> <!-- End Desempenho -->

                    <div class="relatorio-section">
                        <div class="section-header" onclick="toggleSection('financeiro-detalhado-content')">
                            <h2>Situa√ß√£o Financeira Detalhada</h2>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div id="financeiro-detalhado-content" class="collapsible-content active">
                        <div class="table-container">
                            <table class="relatorio-table">
                                <thead>
                                    <tr>
                                        <th>Aluno</th>
                                        <th>Mensalidade</th>
                                        <th>Total Pendente</th>
                                        <th>Status Geral</th>
                                    </tr>
                                </thead>
                                <tbody id="relatorio-financeiro">
                                    <!-- Dados ser√£o injetados aqui -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    </div> <!-- End Financeiro Detalhado -->

                    <div class="relatorio-section">
                        <div class="section-header" onclick="toggleSection('estatisticas-nivel-content')">
                            <h2>Estat√≠sticas por N√≠vel</h2>
                            <span class="toggle-icon">‚ñº</span>
                        </div>
                        <div id="estatisticas-nivel-content" class="collapsible-content active">
                            <div id="relatorio-niveis" class="stats-grid">
                                <!-- Dados ser√£o injetados aqui -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modais -->
    <!-- Modal Aluno -->
    <div id="modal-aluno" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAlunoModal()">&times;</span>
            <h2 id="modal-aluno-titulo">Cadastrar Novo Aluno</h2>
            <form id="form-aluno" onsubmit="salvarAluno(event)">
                <div class="form-group">
                    <label>Nome Completo:</label>
                    <input type="text" id="aluno-nome" required>
                </div>
                <div class="form-group">
                    <label>E-mail:</label>
                    <input type="email" id="aluno-email">
                </div>
                <div class="form-group">
                    <label>Telefone:</label>
                    <input type="text" id="aluno-telefone">
                </div>
                <div class="form-group">
                    <label>Curso/N√≠vel:</label>
                    <select id="aluno-curso" required>
                        <option value="Ingl√™s B√°sico">Ingl√™s B√°sico</option>
                        <option value="Ingl√™s Avan√ßado">Ingl√™s Avan√ßado</option>
                        <option value="Particular">Particular (Individual)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Valor Mensalidade:</label>
                    <input type="number" id="aluno-valor" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>Dia Vencimento:</label>
                    <input type="number" id="aluno-dia-vencimento" min="1" max="31" required>
                </div>
                <div class="form-group">
                    <label>Data de In√≠cio:</label>
                    <input type="date" id="aluno-data" required>
                </div>
                <div class="form-group">
                    <label>Status:</label>
                    <select id="aluno-status" required>
                        <option value="ativo">Ativo</option>
                        <option value="inativo">Inativo</option>
                        <option value="pausado">Pausado</option>
                    </select>
                </div>
                <button type="submit" class="btn-primary">Salvar Aluno</button>
            </form>
        </div>
    </div>

    <!-- Modal M√≥dulo -->
    <div id="modal-modulo" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModuloModal()">&times;</span>
            <h2>Novo M√≥dulo</h2>
            <form id="form-modulo" onsubmit="salvarModulo(event)">
                <div class="form-group">
                    <label>Nome do M√≥dulo:</label>
                    <input type="text" id="modulo-nome" required>
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o:</label>
                    <textarea id="modulo-descricao"></textarea>
                </div>
                <div class="form-group">
                    <label>N√≠vel:</label>
                    <select id="modulo-nivel" required>
                        <option value="basico">B√°sico</option>
                        <option value="avancado">Avan√ßado</option>
                        <option value="particular">Particular</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Data de In√≠cio:</label>
                    <input type="date" id="modulo-data" required>
                </div>
                <button type="submit" class="btn-primary">Criar M√≥dulo</button>
            </form>
        </div>
    </div>

    <!-- Modal Aula -->
    <div id="modal-aula" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAulaModal()">&times;</span>
            <h2>Nova Aula</h2>
            <form id="form-aula" onsubmit="salvarAula(event)">
                <div class="form-group">
                    <label>T√≠tulo da Aula:</label>
                    <input type="text" id="aula-titulo" required>
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o/Conte√∫do:</label>
                    <textarea id="aula-descricao"></textarea>
                </div>
                <div class="form-group">
                    <label>Data da Aula:</label>
                    <input type="date" id="aula-data" required>
                </div>
                <div class="form-group">
                    <label>Dura√ß√£o (minutos):</label>
                    <input type="number" id="aula-duracao" value="60">
                </div>
                <button type="submit" class="btn-primary">Salvar Aula</button>
            </form>
        </div>
    </div>

    <!-- Modal Presen√ßa -->
    <div id="modal-presenca" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closePresencaModal()">&times;</span>
            <h2>Registrar Presen√ßa e Avalia√ß√£o</h2>
            <form id="form-presenca" onsubmit="salvarPresencaComJustificativa(event)">
                <div class="form-group">
                    <label>Aluno:</label>
                    <input type="text" id="presenca-aluno-nome" disabled>
                </div>
                <div class="form-group">
                    <label>Status de Presen√ßa:</label>
                    <select id="presenca-status" onchange="atualizarCamposPresenca()" required>
                        <option value="">-- Selecione --</option>
                        <option value="presente">Presente</option>
                        <option value="falta">Falta</option>
                        <option value="reposta">Reposta</option>
                    </select>
                </div>
                <div id="justificativa-group" class="form-group" style="display:none;">
                    <label>Justificativa:</label>
                    <select id="presenca-justificativa" onchange="atualizarCamposPresenca()">
                        <option value="doenca">Doen√ßa/M√©dico</option>
                        <option value="trabalho">Trabalho</option>
                        <option value="viagem">Viagem</option>
                        <option value="internet">Falta de Internet</option>
                        <option value="luz">Falta de Luz</option>
                        <option value="outros">Outros</option>
                        <option value="nenhuma">Sem Justificativa</option>
                    </select>
                </div>
                <div id="reposicao-group" class="form-group" style="display:none; background: #F3E8FF; padding: 15px; border-radius: 10px; border: 1px solid var(--primary-light);">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; font-weight: 600; color: var(--primary);">
                        <input type="checkbox" id="presenca-repor" onchange="atualizarAvisoReposicao()" style="width: auto;"> 
                        Deseja repor esta aula? (R$ 35,00)
                    </label>
                    <p id="aviso-reposicao" style="color: var(--text-light); font-size: 12px; margin-top: 8px; display: none;">
                        ‚ö†Ô∏è Uma cobran√ßa de <strong>R$ 35,00</strong> ser√° gerada no financeiro.
                    </p>
                </div>
                
                <hr style="margin: 20px 0; border: 0; border-top: 1px solid var(--border);">
                
                <div id="avaliacao-aula-group">
                    <h3>Avalia√ß√£o desta Aula</h3>
                    <div class="form-group">
                        <label>Nota do Desempenho (0-10):</label>
                        <input type="number" id="presenca-nota" min="0" max="10" step="0.5">
                    </div>
                    <div class="form-group">
                        <label>Observa√ß√µes/Pontos a Melhorar:</label>
                        <textarea id="presenca-observacao" rows="3" placeholder="O que o aluno precisa melhorar nesta aula espec√≠fica?"></textarea>
                    </div>
                </div>

                <button type="submit" class="btn-primary">Salvar Registro</button>
            </form>
        </div>
    </div>

    <!-- Modal Pagamento -->
    <div id="modal-pagamento" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModalPagamento()">&times;</span>
            <h2>Atualizar Pagamento</h2>
            <form id="form-pagamento" onsubmit="salvarPagamento(event)">
                <div class="form-group">
                    <label>Aluno:</label>
                    <input type="text" id="pagamento-aluno-nome" disabled>
                </div>
                <div class="form-group">
                    <label>Descri√ß√£o:</label>
                    <input type="text" id="pagamento-descricao" disabled>
                </div>
                <div class="form-group">
                    <label>Valor:</label>
                    <input type="text" id="pagamento-valor" disabled>
                </div>
                <div class="form-group">
                    <label>Data do Pagamento:</label>
                    <input type="date" id="pagamento-data">
                </div>
                <div class="form-group">
                    <label>Status:</label>
                    <select id="pagamento-novo-status" required>
                        <option value="pago">Pago</option>
                        <option value="pendente">Pendente</option>
                        <option value="atrasado">Atrasado</option>
                    </select>
                </div>
                <button type="submit" class="btn-primary">Salvar Pagamento</button>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
